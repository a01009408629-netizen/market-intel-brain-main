name: ðŸ³ Docker Environment Setup

on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'Target environment'
        required: true
        default: 'production'
        type: choice
        options:
          - production
          - staging
          - development
      server_type:
        description: 'Server type'
        required: true
        default: 'ubuntu'
        type: choice
        options:
          - ubuntu
          - amazon-linux
          - centos
      setup_type:
        description: 'Setup type'
        required: true
        default: 'full'
        type: choice
        options:
          - full
          - docker-only
          - compose-only
          - monitoring

env:
  DOCKER_VERSION: "24.0.7"
  COMPOSE_VERSION: "2.21.0"

jobs:
  # ===== DOCKER INSTALLATION =====
  setup-docker-environment:
    name: ðŸ³ Setup Docker Environment
    runs-on: ubuntu-latest
    
    steps:
      - name: ðŸ“¥ Checkout Code
        uses: actions/checkout@v4

      - name: ðŸ³ Create Docker Installation Scripts
        run: |
          mkdir -p docker-setup/{scripts,configs,monitoring}

      - name: ðŸ§ Ubuntu Docker Setup
        run: |
          cat > docker-setup/scripts/install-docker-ubuntu.sh << 'EOF'
          #!/bin/bash
          set -e

          echo "ðŸ³ Installing Docker on Ubuntu..."

          # Update package index
          sudo apt-get update

          # Install packages to allow apt to use a repository over HTTPS
          sudo apt-get install -y \
            apt-transport-https \
            ca-certificates \
            curl \
            gnupg \
            lsb-release \
            software-properties-common

          # Add Docker's official GPG key
          sudo mkdir -p /etc/apt/keyrings
          curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg

          # Set up the repository
          echo \
            "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
            $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

          # Install Docker Engine
          sudo apt-get update
          sudo apt-get install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

          # Start and enable Docker
          sudo systemctl start docker
          sudo systemctl enable docker

          # Add current user to docker group
          sudo usermod -aG docker $USER

          # Verify installation
          sudo docker --version
          sudo docker compose version

          echo "âœ… Docker installed successfully on Ubuntu!"
          EOF

          chmod +x docker-setup/scripts/install-docker-ubuntu.sh

      - name: ðŸ§ Amazon Linux Docker Setup
        run: |
          cat > docker-setup/scripts/install-docker-amazon-linux.sh << 'EOF'
          #!/bin/bash
          set -e

          echo "ðŸ³ Installing Docker on Amazon Linux..."

          # Update package index
          sudo yum update -y

          # Install Docker
          sudo yum install -y docker

          # Start and enable Docker
          sudo systemctl start docker
          sudo systemctl enable docker

          # Add current user to docker group
          sudo usermod -aG docker $USER

          # Install Docker Compose
          sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
          sudo chmod +x /usr/local/bin/docker-compose

          # Verify installation
          sudo docker --version
          sudo docker-compose --version

          echo "âœ… Docker installed successfully on Amazon Linux!"
          EOF

          chmod +x docker-setup/scripts/install-docker-amazon-linux.sh

      - name: ðŸ§ CentOS Docker Setup
        run: |
          cat > docker-setup/scripts/install-docker-centos.sh << 'EOF'
          #!/bin/bash
          set -e

          echo "ðŸ³ Installing Docker on CentOS..."

          # Install required packages
          sudo yum install -y yum-utils

          # Add Docker repository
          sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo

          # Install Docker Engine
          sudo yum install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

          # Start and enable Docker
          sudo systemctl start docker
          sudo systemctl enable docker

          # Add current user to docker group
          sudo usermod -aG docker $USER

          # Verify installation
          sudo docker --version
          sudo docker compose version

          echo "âœ… Docker installed successfully on CentOS!"
          EOF

          chmod +x docker-setup/scripts/install-docker-centos.sh

      - name: ðŸ”§ Create Docker Configuration
        run: |
          cat > docker-setup/configs/daemon.json << 'EOF'
          {
            "log-driver": "json-file",
            "log-opts": {
              "max-size": "10m",
              "max-file": "3"
            },
            "storage-driver": "overlay2",
            "storage-opts": [
              "overlay2.override_kernel_check=true"
            ],
            "default-ulimits": {
              "nofile": {
                "Name": "nofile",
                "Hard": 64000,
                "Soft": 64000
              }
            },
            "registry-mirrors": [],
            "insecure-registries": [],
            "debug": false,
            "experimental": false,
            "metrics-addr": "127.0.0.1:9323",
            "exec-opts": ["native.cgroupdriver=systemd"],
            "bridge": "none",
            "ip-forward": true,
            "iptables": true
          }
          EOF

      - name: ðŸ“Š Create Docker Compose Files
        run: |
          cat > docker-setup/configs/docker-compose.yml << 'EOF'
          version: '3.8'

          services:
            # Market Intel Brain Python Services
            market-intel-python:
              build:
                context: ../../market-intel-brain-main
                dockerfile: Dockerfile
              container_name: market-intel-python
              ports:
                - "8000:8000"
              environment:
                - ENVIRONMENT=${{ github.event.inputs.environment }}
                - REDIS_URL=redis://redis:6379
                - DATABASE_URL=postgresql://postgres:password@postgres:5432/marketintel
              volumes:
                - python_logs:/app/logs
                - python_data:/app/data
              depends_on:
                - redis
                - postgres
              restart: unless-stopped
              networks:
                - marketintel-network
              healthcheck:
                test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
                interval: 30s
                timeout: 10s
                retries: 3
                start_period: 40s

            # Market Intel Brain .NET Services
            market-intel-dotnet:
              build:
                context: ../../dotnet-services
                dockerfile: Dockerfile
              container_name: market-intel-dotnet
              ports:
                - "8080:8080"
              environment:
                - ASPNETCORE_ENVIRONMENT=${{ github.event.inputs.environment }}
                - ASPNETCORE_URLS=http://+:8080
                - ConnectionStrings__Redis=redis://redis:6379
                - ConnectionStrings__PostgreSQL=Host=postgres;Database=marketintel;Username=postgres;Password=password
              volumes:
                - dotnet_logs:/app/logs
                - dotnet_data:/app/data
              depends_on:
                - redis
                - postgres
              restart: unless-stopped
              networks:
                - marketintel-network
              healthcheck:
                test: ["CMD", "curl", "-f", "http://localhost:8080/health"]
                interval: 30s
                timeout: 10s
                retries: 3
                start_period: 40s

            # PostgreSQL Database
            postgres:
              image: postgres:15-alpine
              container_name: marketintel-postgres
              environment:
                - POSTGRES_DB=marketintel
                - POSTGRES_USER=postgres
                - POSTGRES_PASSWORD=password
                - POSTGRES_INITDB_ARGS=--encoding=UTF-8 --lc-collate=C --lc-ctype=C
              volumes:
                - postgres_data:/var/lib/postgresql/data
                - ./postgres/init:/docker-entrypoint-initdb.d
              ports:
                - "5432:5432"
              restart: unless-stopped
              networks:
                - marketintel-network
              healthcheck:
                test: ["CMD-SHELL", "pg_isready -U postgres"]
                interval: 10s
                timeout: 5s
                retries: 5

            # Redis Cache
            redis:
              image: redis:7-alpine
              container_name: marketintel-redis
              command: redis-server --appendonly yes --requirepass redis123
              volumes:
                - redis_data:/data
                - ./redis/redis.conf:/usr/local/etc/redis/redis.conf
              ports:
                - "6379:6379"
              restart: unless-stopped
              networks:
                - marketintel-network
              healthcheck:
                test: ["CMD", "redis-cli", "--raw", "incr", "ping"]
                interval: 10s
                timeout: 3s
                retries: 5

            # Nginx Load Balancer
            nginx:
              image: nginx:alpine
              container_name: marketintel-nginx
              ports:
                - "80:80"
                - "443:443"
              volumes:
                - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
                - ./nginx/ssl:/etc/nginx/ssl:ro
                - nginx_logs:/var/log/nginx
              depends_on:
                - market-intel-python
                - market-intel-dotnet
              restart: unless-stopped
              networks:
                - marketintel-network

            # Prometheus Monitoring
            prometheus:
              image: prom/prometheus:latest
              container_name: marketintel-prometheus
              ports:
                - "9090:9090"
              volumes:
                - ./monitoring/prometheus.yml:/etc/prometheus/prometheus.yml:ro
                - prometheus_data:/prometheus
              command:
                - '--config.file=/etc/prometheus/prometheus.yml'
                - '--storage.tsdb.path=/prometheus'
                - '--web.console.libraries=/etc/prometheus/console_libraries'
                - '--web.console.templates=/etc/prometheus/consoles'
                - '--storage.tsdb.retention.time=200h'
                - '--web.enable-lifecycle'
              restart: unless-stopped
              networks:
                - marketintel-network

            # Grafana Dashboard
            grafana:
              image: grafana/grafana:latest
              container_name: marketintel-grafana
              ports:
                - "3000:3000"
              environment:
                - GF_SECURITY_ADMIN_PASSWORD=admin123
                - GF_USERS_ALLOW_SIGN_UP=false
              volumes:
                - grafana_data:/var/lib/grafana
                - ./monitoring/grafana/provisioning:/etc/grafana/provisioning
              restart: unless-stopped
              networks:
                - marketintel-network

            # Node Exporter for system monitoring
            node-exporter:
              image: prom/node-exporter:latest
              container_name: marketintel-node-exporter
              ports:
                - "9100:9100"
              volumes:
                - /proc:/host/proc:ro
                - /sys:/host/sys:ro
                - /:/rootfs:ro
              command:
                - '--path.procfs=/host/proc'
                - '--path.rootfs=/rootfs'
                - '--path.sysfs=/host/sys'
                - '--collector.filesystem.mount-points-exclude=^/(sys|proc|dev|host|etc)($$|/)'
              restart: unless-stopped
              networks:
                - marketintel-network

          volumes:
            postgres_data:
              driver: local
            redis_data:
              driver: local
            python_logs:
              driver: local
            python_data:
              driver: local
            dotnet_logs:
              driver: local
            dotnet_data:
              driver: local
            nginx_logs:
              driver: local
            prometheus_data:
              driver: local
            grafana_data:
              driver: local

          networks:
            marketintel-network:
              driver: bridge
              ipam:
                config:
                  - subnet: 172.20.0.0/16
          EOF

      - name: ðŸŒ Create Nginx Configuration
        run: |
          mkdir -p docker-setup/configs/nginx
          cat > docker-setup/configs/nginx/nginx.conf << 'EOF'
          events {
              worker_connections 1024;
          }

          http {
              upstream python_backend {
                  server market-intel-python:8000;
              }

              upstream dotnet_backend {
                  server market-intel-dotnet:8080;
              }

              # Rate limiting
              limit_req_zone $binary_remote_addr zone=api:10m rate=20r/s;

              # Log format
              log_format main '$remote_addr - $remote_user [$time_local] "$request" '
                            '$status $body_bytes_sent "$http_referer" '
                            '"$http_user_agent" "$http_x_forwarded_for" '
                            'rt=$request_time uct="$upstream_connect_time" '
                            'uht="$upstream_header_time" urt="$upstream_response_time"';

              access_log /var/log/nginx/access.log main;
              error_log /var/log/nginx/error.log warn;

              # Gzip compression
              gzip on;
              gzip_vary on;
              gzip_min_length 1024;
              gzip_types text/plain text/css text/xml text/javascript application/javascript application/xml+rss application/json;

              server {
                  listen 80;
                  server_name localhost;

                  # Security headers
                  add_header X-Frame-Options DENY;
                  add_header X-Content-Type-Options nosniff;
                  add_header X-XSS-Protection "1; mode=block";
                  add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;

                  # Python API routes
                  location /api/v1/python/ {
                      limit_req zone=api burst=50 nodelay;
                      proxy_pass http://python_backend/;
                      proxy_set_header Host $host;
                      proxy_set_header X-Real-IP $remote_addr;
                      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                      proxy_set_header X-Forwarded-Proto $scheme;
                      proxy_connect_timeout 30s;
                      proxy_send_timeout 30s;
                      proxy_read_timeout 30s;
                  }

                  # .NET API routes
                  location /api/v1/dotnet/ {
                      limit_req zone=api burst=50 nodelay;
                      proxy_pass http://dotnet_backend/;
                      proxy_set_header Host $host;
                      proxy_set_header X-Real-IP $remote_addr;
                      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                      proxy_set_header X-Forwarded-Proto $scheme;
                      proxy_connect_timeout 30s;
                      proxy_send_timeout 30s;
                      proxy_read_timeout 30s;
                  }

                  # Health check
                  location /health {
                      access_log off;
                      return 200 "healthy\n";
                      add_header Content-Type text/plain;
                  }

                  # Prometheus metrics
                  location /metrics {
                      proxy_pass http://prometheus:9090;
                  }

                  # Grafana
                  location /grafana/ {
                      proxy_pass http://grafana:3000/;
                      proxy_set_header Host $host;
                      proxy_set_header X-Real-IP $remote_addr;
                      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                      proxy_set_header X-Forwarded-Proto $scheme;
                  }
              }
          }
          EOF

      - name: ðŸ“Š Create Monitoring Configuration
        run: |
          mkdir -p docker-setup/configs/monitoring
          cat > docker-setup/configs/monitoring/prometheus.yml << 'EOF'
          global:
            scrape_interval: 15s
            evaluation_interval: 15s

          rule_files:
            - "alert_rules.yml"

          alerting:
            alertmanagers:
              - static_configs:
                  - targets: []

          scrape_configs:
            - job_name: 'prometheus'
              static_configs:
                - targets: ['localhost:9090']

            - job_name: 'node-exporter'
              static_configs:
                - targets: ['node-exporter:9100']

            - job_name: 'market-intel-python'
              static_configs:
                - targets: ['market-intel-python:8000']
              metrics_path: /metrics
              scrape_interval: 10s

            - job_name: 'market-intel-dotnet'
              static_configs:
                - targets: ['market-intel-dotnet:8080']
              metrics_path: /metrics
              scrape_interval: 10s

            - job_name: 'nginx'
              static_configs:
                - targets: ['nginx:9113']

            - job_name: 'postgres'
              static_configs:
                - targets: ['postgres:5432']

            - job_name: 'redis'
              static_configs:
                - targets: ['redis:6379']
          EOF

      - name: ðŸ”§ Create Deployment Scripts
        run: |
          cat > docker-setup/scripts/deploy.sh << 'EOF'
          #!/bin/bash
          set -e

          echo "ðŸš€ Deploying Market Intel Brain Services..."

          # Set environment
          ENVIRONMENT="${{ github.event.inputs.environment }}"
          SERVER_TYPE="${{ github.event.inputs.server_type }}"

          echo "ðŸ“¦ Environment: $ENVIRONMENT"
          echo "ðŸ–¥ï¸  Server Type: $SERVER_TYPE"

          # Install Docker based on server type
          case $SERVER_TYPE in
            "ubuntu")
              echo "ðŸ§ Installing Docker on Ubuntu..."
              ./install-docker-ubuntu.sh
              ;;
            "amazon-linux")
              echo "ðŸ§ Installing Docker on Amazon Linux..."
              ./install-docker-amazon-linux.sh
              ;;
            "centos")
              echo "ðŸ§ Installing Docker on CentOS..."
              ./install-docker-centos.sh
              ;;
            *)
              echo "âŒ Unsupported server type: $SERVER_TYPE"
              exit 1
              ;;
          esac

          # Configure Docker daemon
          echo "ðŸ”§ Configuring Docker daemon..."
          sudo mkdir -p /etc/docker
          sudo cp ../configs/daemon.json /etc/docker/daemon.json
          sudo systemctl restart docker

          # Create necessary directories
          echo "ðŸ“ Creating directories..."
          mkdir -p /opt/marketintel/{logs,data,config,ssl}
          sudo chown -R $USER:$USER /opt/marketintel

          # Copy configuration files
          echo "ðŸ“‹ Copying configuration files..."
          cp -r ../configs/* /opt/marketintel/config/

          # Deploy services
          echo "ðŸš€ Deploying services..."
          cd /opt/marketintel/config
          docker compose down --remove-orphans || true
          docker compose pull
          docker compose up -d

          # Wait for services to be ready
          echo "â³ Waiting for services to be ready..."
          sleep 30

          # Check service status
          echo "ðŸ“Š Checking service status..."
          docker compose ps

          # Run health checks
          echo "ðŸ¥ Running health checks..."
          curl -f http://localhost/health || echo "âš ï¸ Health check failed"

          echo "âœ… Deployment completed successfully!"
          echo ""
          echo "ðŸŒ Services available at:"
          echo "  - Main API: http://localhost/api/v1/python/"
          echo "  - .NET API: http://localhost/api/v1/dotnet/"
          echo "  - Grafana: http://localhost/grafana (admin/admin123)"
          echo "  - Prometheus: http://localhost/metrics"
          EOF

          chmod +x docker-setup/scripts/deploy.sh

      - name: ðŸ› ï¸ Create Management Scripts
        run: |
          cat > docker-setup/scripts/manage.sh << 'EOF'
          #!/bin/bash
          set -e

          case "$1" in
            "start")
              echo "ðŸš€ Starting Market Intel services..."
              cd /opt/marketintel/config
              docker compose up -d
              ;;
            "stop")
              echo "ðŸ›‘ Stopping Market Intel services..."
              cd /opt/marketintel/config
              docker compose down
              ;;
            "restart")
              echo "ðŸ”„ Restarting Market Intel services..."
              cd /opt/marketintel/config
              docker compose restart
              ;;
            "logs")
              echo "ðŸ“‹ Showing logs..."
              cd /opt/marketintel/config
              docker compose logs -f
              ;;
            "status")
              echo "ðŸ“Š Service status:"
              cd /opt/marketintel/config
              docker compose ps
              ;;
            "update")
              echo "ðŸ”„ Updating services..."
              cd /opt/marketintel/config
              docker compose pull
              docker compose up -d
              ;;
            "clean")
              echo "ðŸ§¹ Cleaning up..."
              cd /opt/marketintel/config
              docker compose down --volumes --remove-orphans
              docker system prune -f
              ;;
            *)
              echo "Usage: $0 {start|stop|restart|logs|status|update|clean}"
              echo ""
              echo "Commands:"
              echo "  start   - Start all services"
              echo "  stop    - Stop all services"
              echo "  restart - Restart all services"
              echo "  logs    - Show service logs"
              echo "  status  - Show service status"
              echo "  update  - Update and restart services"
              echo "  clean   - Clean up containers and images"
              exit 1
              ;;
          esac
          EOF

          chmod +x docker-setup/scripts/manage.sh

      - name: ðŸ“‹ Create Setup Documentation
        run: |
          cat > docker-setup/README.md << 'EOF'
          # ðŸ³ Market Intel Brain Docker Environment Setup

          ## ðŸš€ Quick Start

          ### 1. Automatic Setup
          ```bash
          # Clone the setup scripts
          git clone https://github.com/a01009408629-netizen/market-intel-brain-main.git
          cd market-intel-brain-main/docker-setup/scripts

          # Run deployment
          ./deploy.sh
          ```

          ### 2. Manual Setup

          #### Install Docker
          ```bash
          # Ubuntu
          ./install-docker-ubuntu.sh

          # Amazon Linux
          ./install-docker-amazon-linux.sh

          # CentOS
          ./install-docker-centos.sh
          ```

          #### Deploy Services
          ```bash
          # Copy configurations
          sudo mkdir -p /opt/marketintel/config
          sudo cp -r ../configs/* /opt/marketintel/config/

          # Deploy
          cd /opt/marketintel/config
          docker compose up -d
          ```

          ## ðŸŒ Services

          After deployment, services will be available at:

          | Service | URL | Credentials |
          |---------|-----|-------------|
          | Python API | http://localhost/api/v1/python/ | - |
          | .NET API | http://localhost/api/v1/dotnet/ | - |
          | Grafana | http://localhost/grafana | admin/admin123 |
          | Prometheus | http://localhost/metrics | - |
          | PostgreSQL | localhost:5432 | postgres/password |
          | Redis | localhost:6379 | redis123 |

          ## ðŸ› ï¸ Management

          Use the management script:
          ```bash
          ./manage.sh start    # Start services
          ./manage.sh stop     # Stop services
          ./manage.sh restart  # Restart services
          ./manage.sh logs     # View logs
          ./manage.sh status   # Check status
          ./manage.sh update   # Update services
          ./manage.sh clean    # Clean up
          ```

          ## ðŸ“Š Monitoring

          - **Grafana**: http://localhost/grafana
            - Username: admin
            - Password: admin123

          - **Prometheus**: http://localhost/metrics

          ## ðŸ”§ Configuration

          All configuration files are located in:
          - `/opt/marketintel/config/` - Main configurations
          - `/opt/marketintel/logs/` - Application logs
          - `/opt/marketintel/data/` - Application data

          ## ðŸ›¡ï¸ Security

          - All services run behind Nginx reverse proxy
          - Rate limiting enabled (20 requests/second)
          - Security headers configured
          - Health checks enabled for all services

          ## ðŸ”„ Updates

          To update all services:
          ```bash
          ./manage.sh update
          ```

          ## ðŸ§¹ Cleanup

          To remove all containers and data:
          ```bash
          ./manage.sh clean
          ```
          EOF

      - name: ðŸ“¤ Upload Docker Setup
        uses: actions/upload-artifact@v4
        with:
          name: docker-environment-setup
          path: docker-setup/
          retention-days: 30

  # ===== DEPLOYMENT VALIDATION =====
  validate-deployment:
    name: âœ… Validate Deployment
    runs-on: ubuntu-latest
    needs: setup-docker-environment
    if: always()
    
    steps:
      - name: ðŸ“¥ Download Setup Files
        uses: actions/download-artifact@v4
        with:
          name: docker-environment-setup
          path: docker-setup/

      - name: ðŸ§ª Test Setup Scripts
        run: |
          echo "ðŸ§ª Testing Docker setup scripts..."
          
          # Test script permissions
          ls -la docker-setup/scripts/
          
          # Test script syntax
          bash -n docker-setup/scripts/install-docker-ubuntu.sh
          bash -n docker-setup/scripts/install-docker-amazon-linux.sh
          bash -n docker-setup/scripts/install-docker-centos.sh
          bash -n docker-setup/scripts/deploy.sh
          bash -n docker-setup/scripts/manage.sh
          
          echo "âœ… All scripts syntax validated!"

      - name: ðŸ“Š Generate Setup Report
        run: |
          echo "# ðŸ³ Docker Environment Setup Report" > setup-report.md
          echo "" >> setup-report.md
          echo "**Setup Date:** $(date)" >> setup-report.md
          echo "**Environment:** ${{ github.event.inputs.environment }}" >> setup-report.md
          echo "**Server Type:** ${{ github.event.inputs.server_type }}" >> setup-report.md
          echo "**Setup Type:** ${{ github.event.inputs.setup_type }}" >> setup-report.md
          echo "" >> setup-report.md
          
          echo "## âœ… Components Ready" >> setup-report.md
          echo "- ðŸ§ Docker installation scripts" >> setup-report.md
          echo "- ðŸ”§ Docker configuration" >> setup-report.md
          echo "- ðŸ“‹ Docker Compose files" >> setup-report.md
          echo "- ðŸŒ Nginx configuration" >> setup-report.md
          echo "- ðŸ“Š Monitoring setup" >> setup-report.md
          echo "- ðŸ› ï¸ Management scripts" >> setup-report.md
          echo "" >> setup-report.md
          
          echo "## ðŸš€ Deployment Steps" >> setup-report.md
          echo "1. Download the setup files from GitHub Actions artifacts" >> setup-report.md
          echo "2. Extract to your server" >> setup-report.md
          echo "3. Run \`./deploy.sh\` to install Docker and deploy services" >> setup-report.md
          echo "4. Access services at the URLs provided in README.md" >> setup-report.md
          echo "" >> setup-report.md
          
          echo "## ðŸŒ Service URLs" >> setup-report.md
          echo "- Python API: http://localhost/api/v1/python/" >> setup-report.md
          echo "- .NET API: http://localhost/api/v1/dotnet/" >> setup-report.md
          echo "- Grafana: http://localhost/grafana (admin/admin123)" >> setup-report.md
          echo "- Prometheus: http://localhost/metrics" >> setup-report.md

      - name: ðŸ“¤ Upload Setup Report
        uses: actions/upload-artifact@v4
        with:
          name: docker-setup-report
          path: setup-report.md
          retention-days: 30
